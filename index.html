<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROS 2 Workspace & Packages Lab - V6.6 Fixed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Kanit', sans-serif; }
        .code-font { font-family: 'Fira Code', monospace; }
        .terminal-cursor::after {
            content: ' '; display: inline-block; width: 10px; height: 1.2em;
            background-color: #3b82f6; animation: blink 1s step-end infinite; vertical-align: middle;
        }
        @keyframes blink { 50% { opacity: 0; } }
        .custom-scroll::-webkit-scrollbar { width: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #1e1e1e; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
        
        .fade-in-up { animation: fadeInUp 0.4s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .glow-command {
            border-left: 3px solid #3b82f6;
            padding-left: 8px;
            background: rgba(59, 130, 246, 0.1);
        }
        .error-command {
            border-left: 3px solid #ef4444;
            padding-left: 8px;
            background: rgba(239, 68, 68, 0.1);
        }
        .term-bg { background-color: #1e1e1e; }
        .term-text { color: #d4d4d4; }
        .prompt-user { color: #4ec9b0; }
        .prompt-path { color: #569cd6; }
    </style>
</head>
<body class="bg-slate-100 h-screen flex flex-col overflow-hidden relative">

    <!-- 1. Registration Screen -->
    <div id="screen-register" class="fixed inset-0 bg-slate-900 z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 to-cyan-500"></div>
            <div class="text-center mb-6">
                <div class="bg-blue-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="box" class="w-10 h-10 text-blue-600"></i>
                </div>
                <h1 class="text-3xl font-bold text-slate-800">ROS 2 Workspace Lab</h1>
                <p class="text-slate-500 text-sm">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Workspace ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Package</p>
            </div>
            <form id="form-register" class="space-y-4">
                <input type="text" id="input-name" required placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                <input type="text" id="input-id" required placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                <input type="text" id="input-group" required placeholder="‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Section)" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700 transition shadow-lg shadow-blue-500/30">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            </form>
        </div>
    </div>

    <!-- 2. Mode Selection Screen -->
    <div id="screen-mode" class="hidden fixed inset-0 bg-slate-50 z-[90] flex items-center justify-center p-4 overflow-y-auto">
        <div class="max-w-6xl w-full py-10">
            <div class="flex justify-between items-end mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-slate-800 mb-1">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <span id="mode-username" class="text-blue-600">User</span> üëã</h2>
                    <p class="text-slate-500">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ (Progress Saved Until Logout)</p>
                </div>
                <button onclick="logout()" class="text-slate-400 hover:text-red-500 flex items-center gap-2 text-sm font-medium transition">
                    <i data-lucide="log-out" class="w-4 h-4"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Tutorial Module -->
                <button onclick="selectMode('tutorial')" class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl transition transform hover:-translate-y-1 text-left border-2 border-transparent hover:border-blue-400 group relative overflow-hidden flex flex-col h-full">
                    <div class="absolute top-0 right-0 bg-blue-500 text-white text-[10px] px-3 py-1 rounded-bl-lg font-bold">Concept & Practice</div>
                    <div class="bg-blue-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:bg-blue-600 transition-colors">
                        <i data-lucide="book-open" class="w-8 h-8 text-blue-600 group-hover:text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">1. ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Tutorial)</h3>
                    <p class="text-slate-500 text-sm mb-4 flex-1">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á `colcon workspace`, ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á package ‡πÅ‡∏ö‡∏ö Python ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô node</p>
                    <div class="mt-4 pt-4 border-t border-gray-100 w-full">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-slate-400">Progress</span>
                            <span id="prog-tutorial" class="text-blue-600 font-bold">0%</span>
                        </div>
                        <div class="w-full h-1.5 bg-gray-100 rounded-full overflow-hidden">
                            <div id="bar-tutorial" class="h-full bg-blue-500 transition-all" style="width: 0%"></div>
                        </div>
                    </div>
                </button>

                <!-- Basic Exam Module -->
                <button onclick="selectMode('exam_basic')" class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl transition transform hover:-translate-y-1 text-left border-2 border-transparent hover:border-yellow-400 group flex flex-col h-full">
                    <div class="bg-yellow-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:bg-yellow-500 transition-colors">
                        <i data-lucide="hammer" class="w-8 h-8 text-yellow-600 group-hover:text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (Basic)</h3>
                    <p class="text-slate-500 text-sm mb-4 flex-1">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Workspace ‡πÅ‡∏•‡∏∞ Package ‡∏ï‡∏≤‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ)</p>
                    <div class="mt-4 pt-4 border-t border-gray-100 w-full">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-slate-400">Score</span>
                            <span id="prog-basic" class="text-yellow-600 font-bold">0/80</span>
                        </div>
                        <div class="w-full h-1.5 bg-gray-100 rounded-full overflow-hidden">
                            <div id="bar-basic" class="h-full bg-yellow-500 transition-all" style="width: 0%"></div>
                        </div>
                    </div>
                </button>

                <!-- Advanced Exam Module -->
                <button onclick="selectMode('exam_advanced')" class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-xl transition transform hover:-translate-y-1 text-left border-2 border-transparent hover:border-purple-400 group flex flex-col h-full">
                    <div class="bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:bg-purple-600 transition-colors">
                        <i data-lucide="rocket" class="w-8 h-8 text-purple-600 group-hover:text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">3. ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö (Adv)</h3>
                    <p class="text-slate-500 text-sm mb-4 flex-1">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏™‡∏£‡πâ‡∏≤‡∏á Robot Workspace ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î Node ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</p>
                    <div class="mt-4 pt-4 border-t border-gray-100 w-full">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-slate-400">Score</span>
                            <span id="prog-adv" class="text-purple-600 font-bold">0/40</span>
                        </div>
                        <div class="w-full h-1.5 bg-gray-100 rounded-full overflow-hidden">
                            <div id="bar-adv" class="h-full bg-purple-500 transition-all" style="width: 0%"></div>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- 3. Main Interface -->
    <div id="screen-lab" class="hidden flex-1 flex flex-col h-full">
        <!-- Header -->
        <header class="bg-slate-800 text-white p-3 shadow-lg flex justify-between items-center shrink-0 z-10 border-b border-slate-700">
            <div class="flex items-center gap-4">
                <div id="mode-badge" class="px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider flex items-center gap-2 bg-blue-600">
                    <i data-lucide="book-open" class="w-3 h-3"></i> Tutorial
                </div>
                <div class="flex flex-col">
                    <div class="text-sm font-bold leading-tight" id="lab-user-name">Name</div>
                    <div class="text-[10px] text-slate-400 font-mono" id="lab-user-id">ID</div>
                </div>
            </div>
            
            <div class="flex items-center gap-6">
                <button onclick="backToHome()" class="text-xs bg-slate-700 hover:bg-slate-600 px-3 py-1.5 rounded transition text-slate-200">
                    <i data-lucide="home" class="w-3 h-3 inline mr-1"></i> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
                <div class="bg-slate-900/50 px-4 py-1.5 rounded-full border border-slate-600 flex items-center gap-2">
                    <i data-lucide="trophy" class="w-4 h-4 text-yellow-500"></i>
                    <span class="text-sm font-mono text-yellow-100"><span id="score-val" class="font-bold text-white text-lg">0</span> pts</span>
                </div>
                <div class="text-right w-32">
                    <div class="text-[10px] text-slate-400 uppercase tracking-wide mb-1">Progress</div>
                    <div class="flex items-center gap-2">
                        <div class="flex-1 h-2 bg-slate-700 rounded-full overflow-hidden">
                            <div id="progress-bar" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <span id="progress-text" class="text-xs font-mono text-white">0/0</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Workspace -->
        <main class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <!-- Left Panel -->
            <section class="w-full md:w-1/2 bg-white flex flex-col border-r border-gray-200 relative">
                <div class="flex-1 overflow-y-auto custom-scroll p-6" id="lesson-scroll-area">
                    <div id="lesson-content" class="max-w-2xl mx-auto space-y-6 pb-32">
                        <!-- Injected -->
                    </div>
                </div>
                <!-- Success Panel -->
                <div id="success-panel" class="hidden absolute bottom-0 left-0 right-0 bg-white border-t-4 border-green-500 p-6 shadow-[0_-10px_40px_rgba(0,0,0,0.1)] z-20">
                    <div class="flex items-start gap-4">
                        <div class="bg-green-100 p-3 rounded-full shrink-0">
                            <i data-lucide="check-circle-2" class="w-8 h-8 text-green-600"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800 mb-1">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                            
                            <!-- Explanation Box (Only for Tutorial) -->
                            <div id="success-explanation-container" class="text-sm text-gray-700 mb-2 font-medium leading-relaxed">
                                <span class="text-blue-600 font-bold">üìù ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Result):</span> 
                                <span id="success-explanation">...</span>
                            </div>

                            <!-- Takeaway Box -->
                            <div class="text-xs text-gray-500 mb-4 bg-gray-50 p-2 rounded border border-gray-200">
                                <strong>üí° Concept:</strong> <span id="success-takeaway">...</span>
                            </div>

                            <div class="flex gap-3">
                                <button onclick="nextLevel()" id="btn-next-level" class="px-6 py-2 bg-green-600 text-white rounded-lg text-sm font-bold hover:bg-green-700 shadow-lg shadow-green-500/30 transition flex items-center gap-2">
                                    ‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Panel: Terminal -->
            <section class="w-full md:w-1/2 term-bg flex flex-col h-1/2 md:h-auto relative border-l border-slate-700">
                <div class="bg-[#2d2d2d] px-4 py-2 flex items-center justify-between border-b border-[#3e3e3e] select-none shrink-0">
                    <div class="flex gap-2">
                        <div class="w-3 h-3 rounded-full bg-[#ff5f56]"></div>
                        <div class="w-3 h-3 rounded-full bg-[#ffbd2e]"></div>
                        <div class="w-3 h-3 rounded-full bg-[#27c93f]"></div>
                    </div>
                    <div class="text-xs text-gray-400 font-mono flex items-center gap-2">
                        <i data-lucide="terminal" class="w-3 h-3"></i> student@ros2_dev: ~/
                    </div>
                </div>
                <div id="terminal-container" class="flex-1 p-4 font-mono text-sm md:text-base term-text overflow-y-auto custom-scroll code-font leading-relaxed" onclick="focusTerminal()">
                    <div class="text-gray-500 mb-2">Ubuntu 22.04.3 LTS</div>
                    <div class="text-gray-500 mb-4" id="terminal-welcome-msg">ROS 2 Humble Hawksbill environment ready.</div>
                    <div id="terminal-history"></div>
                    <div class="flex items-center mt-2">
                        <span class="prompt-user mr-1 font-bold whitespace-nowrap">student@ros2_dev</span>
                        <span class="text-white mr-1">:</span>
                        <span class="prompt-path mr-2 font-bold whitespace-nowrap" id="prompt-path">~</span>
                        <span class="text-white mr-2">$</span>
                        <input type="text" id="terminal-input" autocomplete="off" class="bg-transparent border-none outline-none text-white flex-1 w-full focus:ring-0 p-0 m-0 caret-transparent terminal-cursor">
                    </div>
                    <div id="terminal-bottom" class="h-4"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- 4. Certificate Screen -->
    <div id="screen-cert" class="hidden fixed inset-0 bg-slate-900 z-[200] overflow-y-auto p-4 flex items-center justify-center">
        <div class="bg-white max-w-4xl w-full shadow-2xl relative animate-fade-in-up">
            <div id="cert-content" class="p-12 border-[12px] border-double border-blue-900 bg-white text-center relative">
                <div class="absolute inset-0 opacity-5" style="background-image: radial-gradient(#2563eb 1px, transparent 1px); background-size: 20px 20px;"></div>
                <div class="relative z-10">
                    <div class="flex justify-center mb-6">
                        <div class="bg-blue-600 text-white p-4 rounded-full shadow-xl">
                            <i data-lucide="award" class="w-16 h-16"></i>
                        </div>
                    </div>
                    <h1 class="text-4xl font-serif font-bold text-slate-900 mb-2">CERTIFICATE OF COMPLETION</h1>
                    <p class="text-blue-600 uppercase tracking-[0.2em] text-sm mb-8 font-bold" id="cert-subtitle">ROS 2 Workspace & Packages</p>
                    <p class="text-xl text-slate-600 italic mb-4">This certifies that</p>
                    <h2 id="cert-name" class="text-4xl font-bold text-slate-800 mb-2 pb-2 border-b-2 border-slate-200 inline-block px-10">Name</h2>
                    
                    <div class="mt-8 flex justify-between items-start max-w-2xl mx-auto bg-blue-50 p-6 rounded-xl border border-blue-100">
                        <div class="text-left">
                            <span class="block text-xs text-blue-400 uppercase font-bold">Student ID</span>
                            <div class="font-bold text-slate-700" id="cert-id">ID</div>
                            <div class="text-sm text-slate-600" id="cert-group">Group</div>
                        </div>
                        <div class="text-center">
                             <span class="block text-xs text-blue-400 uppercase font-bold">Module</span>
                             <div class="font-bold text-blue-600 text-lg" id="cert-module">Tutorial</div>
                        </div>
                        <div class="text-right">
                            <span class="block text-xs text-blue-400 uppercase font-bold">Score</span>
                            <div class="font-bold text-green-600 text-2xl" id="cert-score">0</div>
                        </div>
                    </div>
                    
                    <div class="mt-6 text-xs text-slate-400 max-w-2xl mx-auto text-left border-t border-slate-100 pt-2">
                        <span class="font-bold uppercase text-blue-400">Verified Skills:</span>
                        <span id="cert-skills" class="italic">Colcon Build, Workspace Layout, Package Creation, Sourcing Overlay, Running Nodes</span>
                    </div>

                    <div class="mt-10 flex justify-between items-end px-10">
                        <div class="text-left">
                            <p class="text-xs text-slate-400 uppercase">Date</p>
                            <p id="cert-date" class="font-mono text-slate-600">---</p>
                        </div>
                        <div class="text-right">
                            <div class="w-40 border-b border-slate-400 mb-2"></div>
                            <p class="text-xs text-slate-400 uppercase">Instructor Signature</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-slate-100 p-4 flex justify-between items-center border-t border-slate-200 gap-4">
                <button onclick="backToHome()" class="text-slate-500 hover:text-slate-800 text-sm font-medium">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
                <button onclick="saveCert()" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700 flex items-center gap-2 shadow-lg">
                    <i data-lucide="download" class="w-4 h-4"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- DATASET: Tutorial ---
        const tutorialLessons = [
            { 
                id:0, title:"1. Check ROS Environment", 
                desc:"‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ ROS 2 ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î (Source) ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á<br>‡πÇ‡∏î‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô .bashrc ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πá‡∏Ñ Environment Variable", 
                visual:`<i data-lucide="activity" class="w-16 h-16 text-green-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>printenv ROS_DISTRO</code>", cmd:"printenv ROS_DISTRO", 
                hint:"printenv ROS_DISTRO", 
                takeaway:"‡∏ñ‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô 'humble' ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
                explanation:"‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ 'humble' ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ Codename ‡∏Ç‡∏≠‡∏á ROS 2 ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á"
            },
            { 
                id:1, title:"2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Workspace Folder", 
                desc:"‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ä‡∏∑‡πà‡∏≠ <code>ros2_ws</code> ‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå <code>src</code> ‡∏ã‡πâ‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô<br>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á <code>-p</code> ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", 
                visual:`<i data-lucide="folder-plus" class="w-16 h-16 text-blue-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>mkdir -p ~/ros2_ws/src</code>", cmd:"mkdir -p ~/ros2_ws/src", 
                hint:"mkdir -p ~/ros2_ws/src", 
                takeaway:"‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Workspace ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå src ‡πÄ‡∏™‡∏°‡∏≠",
                explanation:"‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ Output ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡πÅ‡∏ï‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 'ros2_ws' ‡πÅ‡∏•‡∏∞ 'src' ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô Home Directory ‡πÅ‡∏•‡πâ‡∏ß"
            },
            { 
                id:2, title:"3. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Workspace", 
                desc:"‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Workspace ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á", 
                visual:`<i data-lucide="arrow-right-circle" class="w-16 h-16 text-yellow-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>cd ~/ros2_ws</code>", cmd:"cd ~/ros2_ws", 
                hint:"cd ~/ros2_ws", 
                takeaway:"‡∏Å‡∏≤‡∏£ Build ‡∏´‡∏£‡∏∑‡∏≠ Source ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏ó‡∏µ‡πà root ‡∏Ç‡∏≠‡∏á workspace (‡∏ó‡∏µ‡πà ros2_ws)",
                explanation:"‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Prompt (‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡∏ü‡πâ‡∏≤) ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô '~/ros2_ws' ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏¢‡πâ‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ñ‡∏π‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß"
            },
            { 
                id:3, title:"4. Initial Build (Colcon)", 
                desc:"‡∏•‡∏≠‡∏á‡∏™‡∏±‡πà‡∏á Build ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏î‡πâ‡∏ß‡∏¢ <code>colcon build</code><br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå setup ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (build, install, log)", 
                visual:`<i data-lucide="package" class="w-16 h-16 text-purple-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>colcon build</code>", cmd:"colcon build", 
                hint:"colcon build", 
                takeaway:"Colcon ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå build, install, log ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
                explanation:"‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏™‡∏î‡∏á Summary ‡∏ß‡πà‡∏≤ Build ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô (0 packages finished) ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà 3 ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏∑‡∏≠ build, install, log"
            },
            { 
                id:4, title:"5. Source Overlay", 
                desc:"‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Build ‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á Source ‡πÑ‡∏ü‡∏•‡πå setup ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå install<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Terminal ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å Workspace ‡∏ô‡∏µ‡πâ (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Overlay)", 
                visual:`<i data-lucide="layers" class="w-16 h-16 text-orange-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>source install/setup.bash</code>", cmd:"source install/setup.bash", 
                hint:"source install/setup.bash", 
                takeaway:"‡∏ï‡πâ‡∏≠‡∏á Source Overlay ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏á Build ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î Terminal ‡πÉ‡∏´‡∏°‡πà",
                explanation:"‡πÑ‡∏°‡πà‡∏°‡∏µ Output ‡πÅ‡∏ï‡πà Terminal ‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á Workspace ‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß (Overlay Environment ‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)"
            },
            { 
                id:5, title:"6. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå src", 
                desc:"‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á Package ‡πÉ‡∏´‡∏°‡πà ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå src ‡∏Å‡πà‡∏≠‡∏ô", 
                visual:`<i data-lucide="folder-open" class="w-16 h-16 text-gray-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>cd src</code>", cmd:"cd src", 
                hint:"cd src", 
                takeaway:"Package ‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå src ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô",
                explanation:"Prompt ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô '~/ros2_ws/src' ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Package ‡πÅ‡∏•‡πâ‡∏ß"
            },
            { 
                id:6, title:"7. ‡∏™‡∏£‡πâ‡∏≤‡∏á Package (Python)", 
                desc:"‡∏™‡∏£‡πâ‡∏≤‡∏á Package ‡∏†‡∏≤‡∏©‡∏≤ Python ‡∏ä‡∏∑‡πà‡∏≠ <code>my_robot_pkg</code><br>‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Node ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ä‡∏∑‡πà‡∏≠ <code>simple_node</code>", 
                visual:`<i data-lucide="code" class="w-16 h-16 text-blue-400"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>ros2 pkg create --build-type ament_python --node-name simple_node my_robot_pkg</code>", 
                cmd:"ros2 pkg create --build-type ament_python --node-name simple_node my_robot_pkg", 
                copy: true,
                hint:"‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Copy Command ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢", 
                takeaway:"ros2 pkg create ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (setup.py, package.xml) ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                explanation:"‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤ Created package 'my_robot_pkg' ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≤‡∏á‡πÜ (setup.py, package.xml, node file)"
            },
            { 
                id:7, title:"8. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Root Workspace", 
                desc:"‡∏™‡∏£‡πâ‡∏≤‡∏á Package ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏≠‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà ros2_ws ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Build", 
                visual:`<i data-lucide="corner-up-left" class="w-16 h-16 text-red-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>cd ~/ros2_ws</code>", cmd:"cd ~/ros2_ws", 
                hint:"cd ~/ros2_ws", 
                takeaway:"‡∏´‡πâ‡∏≤‡∏° run colcon build ‡πÉ‡∏ô src ‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î!",
                explanation:"Prompt ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô '~/ros2_ws' ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ Build"
            },
            { 
                id:8, title:"9. Build Specific Package", 
                desc:"‡∏™‡∏±‡πà‡∏á Build ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Package ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤", 
                visual:`<i data-lucide="zap" class="w-16 h-16 text-yellow-400"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>colcon build --packages-select my_robot_pkg</code>", 
                cmd:"colcon build --packages-select my_robot_pkg", 
                hint:"colcon build --packages-select my_robot_pkg", 
                takeaway:"--packages-select ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å build ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç",
                explanation:"Colcon ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Build ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 'my_robot_pkg' ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏•‡∏á‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå install/"
            },
            { 
                id:9, title:"10. Run Node", 
                desc:"‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏° Source ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á! ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ô Node ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô", 
                visual:`<i data-lucide="play-circle" class="w-16 h-16 text-green-500"></i>`, 
                task:"‡∏û‡∏¥‡∏°‡∏û‡πå <code>source install/setup.bash && ros2 run my_robot_pkg simple_node</code>", 
                cmd:"source install/setup.bash && ros2 run my_robot_pkg simple_node", 
                hint:"‡∏ï‡πâ‡∏≠‡∏á source ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å node ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á build ‡πÄ‡∏™‡∏£‡πá‡∏à", 
                takeaway:"‡∏ñ‡πâ‡∏≤ Node ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° 'Hi from simple_node'",
                explanation:"Node ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢‡∏à‡∏≤‡∏Å Code ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤ Package ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
            }
        ];

        const basicExamLessons = [
            { title:"Q1: Create Workspace", desc:"‡∏à‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå <code>~/dev_ws/src</code>", task:"Create directory tree", cmd:"mkdir -p ~/dev_ws/src" },
            { title:"Q2: Move to WS", desc:"‡∏à‡∏á‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô <code>~/dev_ws</code>", task:"Change dir", cmd:"cd ~/dev_ws" },
            { title:"Q3: First Build", desc:"‡∏à‡∏á‡∏™‡∏±‡πà‡∏á Build Workspace ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å", task:"Build command", cmd:"colcon build" },
            { title:"Q4: Source Overlay", desc:"‡∏à‡∏á Source Setup file ‡∏Ç‡∏≠‡∏á Workspace ‡∏ô‡∏µ‡πâ", task:"Source overlay", cmd:"source install/setup.bash" },
            { title:"Q5: Enter Source", desc:"‡∏à‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå <code>src</code>", task:"Change dir to src", cmd:"cd src" },
            { title:"Q6: Create Package", desc:"‡∏à‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Python Package ‡∏ä‡∏∑‡πà‡∏≠ <code>sensor_pkg</code> Node ‡∏ä‡∏∑‡πà‡∏≠ <code>sensor_node</code>", task:"Create package", cmd:"ros2 pkg create --build-type ament_python --node-name sensor_node sensor_pkg" },
            { title:"Q7: Back to Root", desc:"‡∏à‡∏á‡∏ñ‡∏≠‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà <code>~/dev_ws</code>", task:"Change dir back", cmd:"cd ~/dev_ws" },
            { title:"Q8: Build Package", desc:"‡∏à‡∏á Build ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ <code>sensor_pkg</code>", task:"Build select", cmd:"colcon build --packages-select sensor_pkg" }
        ];

        const advancedExamLessons = [
            { 
                title:"Mission 1: Fix & Build", 
                desc:"‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÅ‡∏• <code>robot_ws</code> ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Build<br>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà <code>~/robot_ws</code> ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏±‡πà‡∏á Build ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", 
                task:"‡πÄ‡∏Ç‡πâ‡∏≤ robot_ws ‡πÅ‡∏•‡πâ‡∏ß Build", 
                type: "scenario",
                check: (state, path, cmd) => path === '~/robot_ws' && cmd === 'colcon build',
                successMsg: "Workspace Built Successfully!"
            },
            {
                title:"Mission 2: Create C++ Package",
                desc:"‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á ‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ C++<br>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏™‡∏£‡πâ‡∏≤‡∏á Package ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô <code>src</code> ‡∏ä‡∏∑‡πà‡∏≠ <code>vision_cpp</code> (Build Type: ament_cmake)",
                task:"‡∏™‡∏£‡πâ‡∏≤‡∏á C++ Package",
                cmd: "ros2 pkg create --build-type ament_cmake vision_cpp",
                type: "step_strict_path", // Must be in src
                requiredPath: "~/robot_ws/src",
                successMsg: "C++ Package Created!"
            },
            {
                title:"Mission 3: Full Integration",
                desc:"‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô<br>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà root, Build ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ <code>vision_cpp</code>, ‡πÅ‡∏•‡πâ‡∏ß Source setup file ‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô",
                task:"Build & Source",
                cmd: "colcon build --packages-select vision_cpp && source install/setup.bash",
                type: "step_strict_path",
                requiredPath: "~/robot_ws",
                successMsg: "Integration Complete!"
            },
            {
                title:"Mission 4: Verify Node",
                desc:"‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô Package ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà<br>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á list packages ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤ vision_cpp",
                task:"List packages",
                cmd: "ros2 pkg list",
                type: "step",
                successMsg: "Verification Passed!"
            }
        ];

        // --- STATE ---
        let user = { name: "", id: "", group: "" };
        let currentMode = "tutorial";
        let currentIndex = 0;
        let score = 0;
        let fileSystem = { 
            '~': ['ros2_ws', 'dev_ws', 'robot_ws'], 
            '~/ros2_ws': ['src'], '~/ros2_ws/src': [],
            '~/dev_ws': ['src'], '~/dev_ws/src': [],
            '~/robot_ws': ['src'], '~/robot_ws/src': []
        };
        let currentPath = "~";
        let isLevelSuccess = false;
        let systemState = { overlaySourced: false, buildCount: 0 };
        
        // Progress storage structure
        let userProgress = {
            tutorial: { idx: 0, score: 0 },
            exam_basic: { idx: 0, score: 0 },
            exam_advanced: { idx: 0, score: 0 }
        };

        // --- INIT & PERSISTENCE ---
        function init() {
            const saved = localStorage.getItem('ros2_workspace_user_v66');
            if(saved) {
                const data = JSON.parse(saved);
                user = data.user;
                userProgress = data.progress || userProgress;
                showModeScreen();
                restoreBars();
            } else {
                document.getElementById('screen-register').classList.remove('hidden');
            }
        }

        function restoreBars() {
            updateBar('tutorial', userProgress.tutorial.idx, 10);
            updateBar('basic', userProgress.exam_basic.score, 80);
            updateBar('adv', userProgress.exam_advanced.score, 40);
        }

        function updateBar(key, val, max) {
            const pct = (val / max) * 100;
            const elBar = document.getElementById(`bar-${key}`);
            const elText = document.getElementById(`prog-${key}`);
            if(elBar) elBar.style.width = `${pct}%`;
            if(elText) elText.innerText = key==='tutorial' ? `${Math.round(pct)}%` : `${val}/${max}`;
        }

        function saveState() {
            localStorage.setItem('ros2_workspace_user_v66', JSON.stringify({ user, progress: userProgress }));
        }

        document.getElementById('form-register').addEventListener('submit', (e) => {
            e.preventDefault();
            user.name = document.getElementById('input-name').value;
            user.id = document.getElementById('input-id').value;
            user.group = document.getElementById('input-group').value;
            saveState();
            showModeScreen();
        });

        function showModeScreen() {
            document.getElementById('screen-register').classList.add('hidden');
            document.getElementById('screen-lab').classList.add('hidden');
            document.getElementById('screen-cert').classList.add('hidden');
            document.getElementById('screen-mode').classList.remove('hidden');
            document.getElementById('mode-username').innerText = user.name;
            restoreBars();
        }

        function logout() {
            localStorage.removeItem('ros2_workspace_user_v66');
            location.reload();
        }

        function selectMode(mode) {
            currentMode = mode;
            currentIndex = userProgress[mode].idx;
            score = userProgress[mode].score;
            isLevelSuccess = false;
            currentPath = "~";
            systemState.overlaySourced = false;
            
            document.getElementById('screen-mode').classList.add('hidden');
            document.getElementById('screen-lab').classList.remove('hidden');

            const badge = document.getElementById('mode-badge');
            let color = mode.includes('basic') ? 'bg-yellow-600' : (mode.includes('advanced') ? 'bg-purple-600' : 'bg-blue-600');
            badge.className = `px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider flex items-center gap-2 ${color}`;
            badge.innerText = mode.toUpperCase().replace('_', ' ');

            document.getElementById('lab-user-name').innerText = user.name;
            document.getElementById('lab-user-id').innerText = user.id;

            loadLesson();
            lucide.createIcons();
            document.getElementById('terminal-input').focus();
        }

        function getLessons() {
            if(currentMode === 'tutorial') return tutorialLessons;
            if(currentMode === 'exam_basic') return basicExamLessons;
            return advancedExamLessons;
        }

        function loadLesson() {
            const list = getLessons();
            if(currentIndex >= list.length) { finishModule(); return; }
            const lesson = list[currentIndex];
            
            document.getElementById('success-panel').classList.add('hidden');
            isLevelSuccess = false;

            const container = document.getElementById('lesson-content');
            if (currentMode === 'tutorial') {
                container.innerHTML = `
                    <div class="fade-in-up">
                        <div class="text-xs font-bold text-blue-500 uppercase mb-2">Step ${currentIndex+1}/${list.length}</div>
                        <h2 class="text-3xl font-bold text-slate-800 mb-4">${lesson.title}</h2>
                        <div class="flex justify-center my-6"><div class="bg-blue-50 p-6 rounded-full shadow-inner">${lesson.visual}</div></div>
                        <div class="text-slate-600 mb-6 leading-relaxed text-lg">${lesson.desc}</div>
                        <div class="bg-blue-50 border border-blue-100 p-5 rounded-xl">
                            <h4 class="font-bold text-blue-700 mb-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (Command):</h4>
                            <div class="bg-white p-3 rounded border border-blue-200 font-mono text-slate-800 text-sm break-all">
                                ${lesson.task}
                            </div>
                            ${lesson.copy ? `<button onclick="copyToTerm('${lesson.cmd.replace(/'/g, "\\'")}')" class="mt-3 bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-700 flex items-center gap-2 transition w-full justify-center"><i data-lucide="copy" class="w-4 h-4"></i> Copy Command</button>` : ''}
                            <div class="mt-3 text-sm text-slate-500 flex items-center gap-2"><i data-lucide="lightbulb" class="w-4 h-4 text-yellow-500"></i> Hint: ${lesson.hint}</div>
                        </div>
                    </div>`;
            } else {
                let color = currentMode.includes('basic') ? 'text-yellow-600' : 'text-purple-600';
                container.innerHTML = `
                    <div class="fade-in-up">
                        <div class="text-xs font-bold ${color} uppercase mb-2">Task ${currentIndex+1}/${list.length}</div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-4">${lesson.title}</h2>
                        <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm mb-4">${lesson.desc}</div>
                        <div class="bg-slate-800 text-white p-4 rounded-lg"><div class="text-xs text-slate-400 mb-1">TASK</div>${lesson.task}</div>
                    </div>`;
            }
            lucide.createIcons();
            updateStats();
        }

        function updateStats() {
            const list = getLessons();
            const pct = (currentIndex / list.length) * 100;
            document.getElementById('progress-bar').style.width = `${pct}%`;
            document.getElementById('progress-text').innerText = `${currentIndex}/${list.length}`;
            document.getElementById('score-val').innerText = score;
        }

        function copyToTerm(cmd) {
            document.getElementById('terminal-input').value = cmd;
            document.getElementById('terminal-input').focus();
        }

        // --- LOGIC ENGINE ---
        function checkCommand(rawInput) {
            const input = rawInput.trim();
            if(!input) return;
            const parts = input.split(' ');
            const cmd = parts[0];
            const arg = parts.slice(1).join(' ');
            const list = getLessons();
            const lesson = list[currentIndex];

            let output = "";
            let isSimulation = false;
            let isMissionCorrect = false;

            // --- VIRTUAL FS & LOGIC (Restored Missing Commands) ---
            if (cmd === 'printenv') {
                if(input.includes('ROS_DISTRO')) output = "humble";
            } 
            else if (cmd === 'mkdir') {
                const pathStr = parts.includes('-p') ? parts[parts.length-1] : parts[1];
                if(pathStr && !fileSystem[currentPath]) fileSystem[currentPath] = []; // simplified logic
            }
            else if (cmd === 'cd') {
                if(!arg || arg === '~') currentPath = '~';
                else if(arg === 'src') currentPath += '/src';
                else if(arg.includes('ros2_ws')) currentPath = '~/ros2_ws';
                else if(arg.includes('dev_ws')) currentPath = '~/dev_ws';
                else if(arg.includes('robot_ws')) currentPath = '~/robot_ws';
                else output = `bash: cd: ${arg}: No such directory`;
                document.getElementById('prompt-path').innerText = currentPath;
            }
            else if (cmd === 'ls') {
                // Show something based on current path
                if (currentPath === '~') output = "ros2_ws  dev_ws  robot_ws  Desktop  Downloads";
                else if (currentPath.endsWith('src')) output = "CMakeLists.txt";
                else if (currentPath.endsWith('ws')) output = "build  install  log  src";
                else output = "";
            }
            else if (cmd === 'pwd') {
                output = currentPath.replace('~', '/home/student');
            }
            else if (cmd === 'touch') { /* simulate success */ }
            else if (cmd === 'cp') { /* simulate success */ }
            else if (cmd === 'rm') { /* simulate success */ }
            else if (cmd === 'colcon') {
                if(arg.includes('build')) {
                    isSimulation = true;
                    simulateBuild(() => finalizeCommand(input, lesson));
                    return;
                }
            }
            else if (cmd === 'source') {
                if(arg.includes('setup.bash')) systemState.overlaySourced = true;
            }
            else if (cmd === 'ros2') {
                if(parts[1] === 'pkg' && parts[2] === 'create') {
                    output = `Package '${parts[parts.length-1]}' created.\n[INFO] Created package.xml\n[INFO] Created setup.py`;
                }
                else if (parts[1] === 'run') {
                    if(systemState.overlaySourced) output = `[INFO] [${Date.now()}]: Hi from simple_node!`;
                    else output = `Package '${parts[2]}' not found (Did you source the overlay?)`;
                }
                else if (parts[1] === 'pkg' && parts[2] === 'list') {
                    output = "my_robot_pkg\nvision_cpp\nstd_msgs\nrclpy";
                }
            }
            else if (cmd === 'clear') {
                document.getElementById('terminal-history').innerHTML='';
                document.getElementById('terminal-input').value='';
                if(lesson.cmd === 'clear') finalizeCommand(input, lesson);
                return;
            }

            finalizeCommand(input, lesson, output);
        }

        function finalizeCommand(input, lesson, output = "") {
            document.getElementById('terminal-input').disabled = false;
            document.getElementById('terminal-input').focus();
            
            let isCorrect = false;
            // Clean input for comparison
            const cleanInput = input.replace(/\s+/g, ' ').trim();
            const cleanTarget = lesson.cmd ? lesson.cmd.replace(/\s+/g, ' ').trim() : "";

            // Check
            if (currentMode === 'exam_advanced') {
                if (lesson.type === 'scenario') {
                    if(lesson.check(systemState, currentPath, cleanInput)) isCorrect = true;
                } else if (lesson.type === 'step_strict_path') {
                    if(currentPath === lesson.requiredPath && cleanInput.includes(lesson.cmd.split(' ')[0])) isCorrect = true;
                } else if (lesson.type === 'step') {
                    if(cleanInput === cleanTarget) isCorrect = true;
                }
            } else if (currentMode === 'exam_basic') {
                // FIXED: Relaxed check for exam basic
                // Check if command contains key parts instead of strict equality
                const keywords = lesson.cmd.split(' ').filter(w => !w.startsWith('-'));
                // Basic check: must contain main command and main args
                const mainCmd = keywords[0];
                if (cleanInput.startsWith(mainCmd) && keywords.every(k => cleanInput.includes(k))) {
                    isCorrect = true;
                }
            } else {
                // Tutorial
                if(cleanInput === cleanTarget) isCorrect = true;
                // Special handling for chained commands in tutorial #10
                if(lesson.id === 9 && cleanInput.includes('ros2 run')) isCorrect = true;
            }

            // Tutorial Strict Mode: Retry if wrong
            if(currentMode === 'tutorial' && !isCorrect && !input.includes('clear')) {
                const valid = ['ls', 'pwd', 'whoami', 'date'];
                if(valid.includes(input.split(' ')[0])) {
                    addHistory(input, output, false);
                } else {
                    addHistory(input, `‚ùå ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î! ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå: ${lesson.hint}`, false, true);
                }
                document.getElementById('terminal-input').value = '';
                return;
            }

            addHistory(input, output, isCorrect);
            document.getElementById('terminal-input').value = '';

            if (isCorrect) triggerSuccess(lesson);
        }

        function simulateBuild(callback) {
            const hist = document.getElementById('terminal-history');
            const id = 'build-log-' + Date.now();
            hist.innerHTML += `<div id="${id}" class="text-gray-400 text-xs mb-2"></div>`;
            const log = document.getElementById(id);
            
            const pkgs = ['std_msgs', 'geometry_msgs', 'my_robot_pkg'];
            let i = 0;
            const interval = setInterval(() => {
                if (i < pkgs.length) {
                    log.innerHTML += `Starting >>> ${pkgs[i]}<br>Finished <<< ${pkgs[i]} [0.5s]<br>`;
                    document.getElementById('terminal-container').scrollTop = document.getElementById('terminal-container').scrollHeight;
                    i++;
                } else {
                    clearInterval(interval);
                    log.innerHTML += "<span class='text-green-400'>Summary: 3 packages finished [1.5s]</span>";
                    callback();
                }
            }, 400);
        }

        function triggerSuccess(lesson) {
            if(!isLevelSuccess) {
                isLevelSuccess = true;
                score += 10;
                userProgress[currentMode].score = score;
                saveState();
                updateStats();
                
                // --- NEW EXPLANATION LOGIC ---
                if (currentMode === 'tutorial') {
                    document.getElementById('success-explanation-container').classList.remove('hidden');
                    document.getElementById('success-explanation').innerText = lesson.explanation || "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô (Action Completed)";
                } else {
                    document.getElementById('success-explanation-container').classList.add('hidden');
                }
                
                document.getElementById('success-takeaway').innerText = lesson.takeaway || lesson.successMsg || "Task Completed";
                
                document.getElementById('success-panel').classList.remove('hidden');
                document.getElementById('success-panel').classList.add('fade-in-up');
                document.getElementById('btn-next-level').focus();
            }
        }

        function addHistory(cmd, output, isSuccess, isError=false) {
            const div = document.createElement('div');
            div.className = "mb-2 animate-fade-in";
            
            let highlight = "";
            if (isSuccess) highlight = "glow-command";
            if (isError) highlight = "error-command text-red-400";

            div.innerHTML = `
                <div class="flex items-center ${highlight}">
                    <span class="prompt-user mr-1 font-bold whitespace-nowrap">student</span>
                    <span class="text-white mr-1">:</span>
                    <span class="prompt-path mr-2 font-bold whitespace-nowrap">${document.getElementById('prompt-path').innerText}</span>
                    <span class="text-white mr-2">$</span>
                    <span class="text-white font-mono">${cmd}</span>
                    ${isSuccess?'<i data-lucide="check" class="w-4 h-4 text-green-400 ml-2"></i>':''}
                </div>
                ${output?`<div class="text-gray-300 whitespace-pre-wrap ml-0 mt-1 font-mono text-sm">${output}</div>`:''}
            `;
            document.getElementById('terminal-history').appendChild(div);
            lucide.createIcons();
            document.getElementById('terminal-container').scrollTop = document.getElementById('terminal-container').scrollHeight;
        }

        function nextLevel() {
            const list = getLessons();
            if(currentIndex < list.length - 1) {
                currentIndex++;
                userProgress[currentMode].idx = currentIndex;
                saveState();
                loadLesson();
            } else {
                finishModule();
            }
        }

        function finishModule() {
            document.getElementById('screen-lab').classList.add('hidden');
            document.getElementById('screen-cert').classList.remove('hidden');
            
            document.getElementById('cert-name').innerText = user.name;
            document.getElementById('cert-id').innerText = user.id;
            document.getElementById('cert-group').innerText = user.group;
            document.getElementById('cert-score').innerText = score;
            document.getElementById('cert-module').innerText = currentMode.toUpperCase().replace('_', ' ');
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString('th-TH');
        }

        function backToHome() {
            document.getElementById('screen-lab').classList.add('hidden');
            document.getElementById('screen-cert').classList.add('hidden');
            showModeScreen();
        }
        
        function saveCert() {
            html2canvas(document.getElementById('cert-content')).then(canvas => {
                const link = document.createElement('a');
                link.download = `ROS2_Workspace_${currentMode}_${user.id}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        document.getElementById('terminal-input').addEventListener('keydown', (e) => {
            if(e.key === 'Enter' && !e.target.disabled) checkCommand(document.getElementById('terminal-input').value);
        });

        init();
    </script>
</body>
</html>
